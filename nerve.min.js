var nerve;
(function(g){function l(a,b,d){for(var f=0,e=c[a][b].length;f<e;f++)(function(a,b,f){var e=setTimeout(function(){try{c[a][b][f].callback.call(c[a][b][f].caller,d),clearTimeout(e)}catch(g){}})})(a,b,f)}function k(a,b){for(var d=0,c=a.length;d<c;d++)a[d]&&a[d].caller===b&&(a.splice(d,1),d--)}var c={};g.on=function(a){var b=null;if(!(b=!a.hasOwnProperty("channel"))&&!(b=!a.hasOwnProperty("callback")))var b=a.callback,d={},b=!(b&&"[object Function]"===d.toString.call(b));if(b)throw Error("A channel and a callback must be specified");b=
a.hasOwnProperty("scope")?a.scope||null:null;c.hasOwnProperty(a.channel)||(c[a.channel]={});a.hasOwnProperty("route")||(a.route="root");c[a.channel].hasOwnProperty(a.route)||(c[a.channel][a.route]=[]);a:{var d=b,f=a.callback,e=c[a.channel][a.route];if(e)for(var h=0,g=e.length;h<g;h++)if(console.log(e[h]),e[h].caller===d&&e[h].callback===f){d=e[h];break a}d=null}d||c[a.channel][a.route].push({caller:b,callback:a.callback})};g.send=function(a){if(!a.hasOwnProperty("channel"))throw Error("A channel must be specified");
a.hasOwnProperty("route")||(a.route="root");a.hasOwnProperty("context")||(a.context=null);c.hasOwnProperty(a.channel)&&c[a.channel].hasOwnProperty(a.route)&&l(a.channel,a.route,a.context);c.hasOwnProperty(a.channel)&&c[a.channel].hasOwnProperty("root")&&l(a.channel,"root",a.context)};g.off=function(a){var b=a.channel,d=a.route;a=a.scope;if(b&&!d&&!a&&c[b])delete c[b];else if(b&&d&&!a&&c[b]&&c[b].hasOwnProperty(d))delete c[b][d];else if(b&&d&&a&&c[b]&&c[b].hasOwnProperty(d))k(c[b][d],a);else if(b&&
!d&&a&&c[b])for(var f in c[b])c[b].hasOwnProperty(f)&&k(c[b][f],a);else if(!b&&d&&!a)for(b in c)c[b].hasOwnProperty(d)&&delete c[b][d];else if(!b&&d&&a)for(b in c)c[b].hasOwnProperty(d)&&k(c[b][d],a);else if(!b&&!d&&a)for(var e in c)for(d in b=c[e],b)b.hasOwnProperty(d)&&k(b[d],a)};"object"===typeof module&&(module.exports=g)})(nerve||(nerve={}));
